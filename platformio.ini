; ESP32-S3-PoE-ETH (W5500) Deskflow Client
; Waveshare board â€” Ethernet + BLE HID bridge

[env:esp32-s3-devkitc-1]
platform = espressif32
board = esp32-s3-devkitc-1
framework = arduino

; ESP32-S3 dual-core, 240MHz, 512KB SRAM typical
board_build.mcu = esp32s3
board_build.f_cpu = 240000000L

; Partition scheme: default or minimal SPIFFS for WebUI
board_build.partitions = default.csv

; Serial monitor for logs
monitor_speed = 115200

; Libraries
; Ethernet: use local lib/Ethernet (patched for W5500 SPI pins 12,13,11,10)
; ESP32-BLE-Combo: single BLE device for keyboard+mouse (avoids dual-server conflict)
; NimBLE-Arduino: more reliable BLE stack for HID devices
lib_deps =
    links2004/WebSockets@^2.4.1
    bblanchon/ArduinoJson@^6.21.3
    h2zero/NimBLE-Arduino@^1.4.1
    https://github.com/Georgegipa/ESP32-BLE-Combo.git

; Build flags: W5500 pins and feature toggles
; ARDUINO_USB_CDC_ON_BOOT=1 sends Serial over USB (required for ESP32-S3 native USB)
; USE_NIMBLE: use NimBLE stack instead of Bluedroid (more reliable for HID)
build_flags =
    -DARDUINO_USB_CDC_ON_BOOT=1
    -DCORE_DEBUG_LEVEL=1
    -DUSE_NIMBLE
    -DW5500_SCK=13
    -DW5500_MISO=12
    -DW5500_MOSI=11
    -DW5500_CS=14
    -DW5500_INT=10
    -DW5500_RST=9

; Upload and flash
upload_speed = 921600
